---
 title: "Основы обработки данных с помощью R и Dplyr"
 author: "gtishckov@yandex.ru"
 format: 
   md:
     output-file: README.md
---

# Основы обработки данных с помощью R и Dplyr

gtishckov@yandex.ru

## Цель работы

Развить практические навыки использования функций обработки данных пакета dplyr – функции select(), filter(), mutate(), arrange(), group_by()

## Исходные данные

1.  Программное обеспечение Windows 11

2.  Rstudio Desktop

3.  Интерпретатор языка R 4.4.1

4.  Программный пакет dplyr

## План

1.  Установить программный пакет dplyr

2.  Проанализировать набор данных

3.  Ответить на вопросы

## Шаги

1.  Для начала прохождения курса необходимо установить программный пакет dplyr.

    ```         
    install.packages("dplyr")
    ```

2.  Загружаем библиотеку. и выполняем задания

a\) Сколько строк в датафрейме?

```{r}
library(dplyr)

starwars %>% nrow()

```

```{r}
[1] 87
```
b\) Сколько столбцов в датафрейме?

```{r}
starwars %>% ncol()
```

```{r}
[1] 14
```
c\) Как просмотреть примерный вид датафрейма?

```{r}
starwars %>% glimpse()
```

```{r}
Rows: 87
Columns: 14
$ name       <chr> "Luke Skywalker", "C-3PO", "R2-D2", "Darth Vader", "Leia Or…
$ height     <int> 172, 167, 96, 202, 150, 178, 165, 97, 183, 182, 188, 180, 2…
$ mass       <dbl> 77.0, 75.0, 32.0, 136.0, 49.0, 120.0, 75.0, 32.0, 84.0, 77.…
$ hair_color <chr> "blond", NA, NA, "none", "brown", "brown, grey", "brown", N…
$ skin_color <chr> "fair", "gold", "white, blue", "white", "light", "light", "…
$ eye_color  <chr> "blue", "yellow", "red", "yellow", "brown", "blue", "blue",…
$ birth_year <dbl> 19.0, 112.0, 33.0, 41.9, 19.0, 52.0, 47.0, NA, 24.0, 57.0, …
$ sex        <chr> "male", "none", "none", "male", "female", "male", "female",…
$ gender     <chr> "masculine", "masculine", "masculine", "masculine", "femini…
$ homeworld  <chr> "Tatooine", "Tatooine", "Naboo", "Tatooine", "Alderaan", "T…
$ species    <chr> "Human", "Droid", "Droid", "Human", "Human", "Human", "Huma…
$ films      <list> <"A New Hope", "The Empire Strikes Back", "Return of the J…
$ vehicles   <list> <"Snowspeeder", "Imperial Speeder Bike">, <>, <>, <>, "Imp…
$ starships  <list> <"X-wing", "Imperial shuttle">, <>, <>, "TIE Advanced x1",…
```

d\) Сколько уникальных рас персонажей (species) представлено в данных?

```{r}
starwars %>% distinct(species)

```

```{r}
[1] 38
```
e\) Найти самого высокого персонажа.

```{r}

max_values <- starwars 
```

f\) Найти всех персонажей ниже 170

```{r}
starwars %>% filter(!is.na(height) & height < 170) %>% select(name,height)
```

g\) Подсчитать ИМТ (индекс массы тела) для всех персонажей. ИМТ подсчитать по формуле

```{r}
starwars %>% filter(!is.na(mass) & !is.na(height)) %>% mutate(bmi = mass / (height/100)^2) %>% select(name,bmi)

```

h\) Найти 10 самых “вытянутых” персонажей. “Вытянутость” оценить по отношению массы (mass) к росту (height) персонажей.

```{r}
    starwars %>% filter(!is.na(mass) & !is.na(height)) %>% mutate(stretch = mass / height) %>% arrange(desc(stretch)) %>% slice(1:10) %>% select(name,stretch)
    ```

i\) Найти средний возраст персонажей каждой расы вселенной Звездных войн.

```{r}
    starwars %>% filter(!is.na(species) & !is.na(birth_year)) %>% group_by(species) %>% summarise(average_age = mean(birth_year, na.rm = TRUE))
    ```

j\)Найти самый распространенный цвет глаз персонажей вселенной Звездных войн.

```{r}
    starwars %>% filter(!is.na(eye_color)) %>% group_by(eye_color) %>% summarise(count = n()) %>% arrange(desc(count)) %>% slice(1)
    ```

k\) Подсчитать среднюю длину имени в каждой расе вселенной Звездных войн.

```{r}
    starwars %>% filter(!is.na(species) & !is.na(name)) %>% mutate(name_length = nchar(name)) %>% group_by(species) %>% summarise(len = mean(name_length, na.rm = TRUE))
    ```

## Оценка результата

В результате работы была скачана библиотека dplyr и были выполнены задания с использованием набора данных starwars.

## Вывод

Были изучены функции библиотеки dplyr. Были выполнены поставленные практикой задачи.
